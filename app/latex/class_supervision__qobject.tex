\hypertarget{class_supervision__qobject}{}\doxysection{Supervision\+\_\+qobject Class Reference}
\label{class_supervision__qobject}\index{Supervision\_qobject@{Supervision\_qobject}}


The \mbox{\hyperlink{class_supervision__qobject}{Supervision\+\_\+qobject}} class.  




{\ttfamily \#include $<$supervision.\+h$>$}

Inheritance diagram for Supervision\+\_\+qobject\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2.000000cm]{class_supervision__qobject}
\end{center}
\end{figure}
\doxysubsection*{Public Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_supervision__qobject_ad2afdb21031a6ab2fe480cb57c9291e7}{ihm\+\_\+post\+\_\+badge}} (Q\+String, Q\+String, Q\+String, Q\+String)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ad2afdb21031a6ab2fe480cb57c9291e7}{Supervision\+\_\+qobject\+::ihm\+\_\+post\+\_\+badge}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{supervision\+\_\+init\+\_\+http}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{Supervision\+\_\+qobject\+::supervision\+\_\+init\+\_\+http}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\+\_\+http\+\_\+status}} (int)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{Supervision\+\_\+qobject\+::supervision\+\_\+http\+\_\+status}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Signals}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a3c8c2580ec0c610cd5859859a476facb}\label{class_supervision__qobject_a3c8c2580ec0c610cd5859859a476facb}} 
void {\bfseries signal\+\_\+ihm\+\_\+http\+\_\+status} (Q\+Variant)
\item 
\mbox{\Hypertarget{class_supervision__qobject_a376fc32225b9ead5816403005d3c10b4}\label{class_supervision__qobject_a376fc32225b9ead5816403005d3c10b4}} 
void {\bfseries signal\+\_\+ihm\+\_\+badge\+\_\+db\+\_\+status} (Q\+Variant)
\item 
\mbox{\Hypertarget{class_supervision__qobject_a47b44896aaa7290f6ead133c70f6f45f}\label{class_supervision__qobject_a47b44896aaa7290f6ead133c70f6f45f}} 
void {\bfseries signal\+\_\+display\+\_\+message} (Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant, Q\+Variant)
\item 
\mbox{\Hypertarget{class_supervision__qobject_ab07aeb26e200bab063f08995bbaf20df}\label{class_supervision__qobject_ab07aeb26e200bab063f08995bbaf20df}} 
void {\bfseries signal\+\_\+x7\+Gest\+Config\+\_\+init\+\_\+mode\+\_\+network} (void)
\item 
\mbox{\Hypertarget{class_supervision__qobject_ad881f9a83557a2be469be845bb7b22ed}\label{class_supervision__qobject_ad881f9a83557a2be469be845bb7b22ed}} 
void {\bfseries signal\+\_\+process\+\_\+init\+\_\+http} (void)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_supervision__qobject_af5f668f55d568f996800c348e4b7b10d}\label{class_supervision__qobject_af5f668f55d568f996800c348e4b7b10d}} 
\mbox{\hyperlink{class_supervision__qobject_af5f668f55d568f996800c348e4b7b10d}{Supervision\+\_\+qobject}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_af5f668f55d568f996800c348e4b7b10d}{Supervision\+\_\+qobject\+::\+Supervision\+\_\+qobject}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_abe8123ea66b3ce11ba6c06ec5c5e441e}{supervision\+\_\+init}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_abe8123ea66b3ce11ba6c06ec5c5e441e}{Supervision\+\_\+qobject\+::supervision\+\_\+init}}. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{class_supervision__qobject_a974d073fd26ff6ca921f009af5524a4f}\label{class_supervision__qobject_a974d073fd26ff6ca921f009af5524a4f}} 
bool {\bfseries post\+\_\+get} (Q\+Url $\ast$, Q\+String)
\item 
void \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\+\_\+badge\+\_\+db\+\_\+status}} (int)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{Supervision\+\_\+qobject\+::supervision\+\_\+badge\+\_\+db\+\_\+status}}. \end{DoxyCompactList}\item 
Q\+Byte\+Array \mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{encode\+\_\+string}} (Q\+Byte\+Array s)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{Supervision\+\_\+qobject\+::encode\+\_\+string}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{sauvegarde\+Badge}} (int id)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{Supervision\+\_\+qobject\+::sauvegarde\+Badge}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{demarre\+Trigger}} (int high, int low)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{Supervision\+\_\+qobject\+::demarre\+Trigger}}. \end{DoxyCompactList}\item 
Q\+String \mbox{\hyperlink{class_supervision__qobject_a864bf60af5bfa0bb83f7ed98518fe0ed}{get\+Time2bii\+\_\+name}} () const
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a864bf60af5bfa0bb83f7ed98518fe0ed}{Supervision\+\_\+qobject\+::get\+Time2bii\+\_\+name}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_ad029236018c16cac96497b4ab136dac6}{set\+Time2bii\+\_\+name}} (const Q\+String \&value)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ad029236018c16cac96497b4ab136dac6}{Supervision\+\_\+qobject\+::set\+Time2bii\+\_\+name}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_afea58f3259299107ede363a74a5e0110}{custom\+Event}} (Q\+Event $\ast$event)
\begin{DoxyCompactList}\small\item\em (N\+OT U\+S\+ED) \mbox{\hyperlink{class_supervision__qobject_afea58f3259299107ede363a74a5e0110}{Supervision\+\_\+qobject\+::custom\+Event}} \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \mbox{\hyperlink{class_supervision__qobject}{Supervision\+\_\+qobject}} $\ast$ \mbox{\hyperlink{class_supervision__qobject_aa72329b1b5f3e30906561ea49224dcaa}{get\+Instance}} ()
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_aa72329b1b5f3e30906561ea49224dcaa}{Supervision\+\_\+qobject\+::get\+Instance}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a00b357ea457b454e45790bf429b20aba}\label{class_supervision__qobject_a00b357ea457b454e45790bf429b20aba}} 
Q\+String {\bfseries version\+\_\+logiciel}
\item 
\mbox{\Hypertarget{class_supervision__qobject_aa334be413f8a8c19d660a3592aabda97}\label{class_supervision__qobject_aa334be413f8a8c19d660a3592aabda97}} 
Q\+String {\bfseries key\+\_\+crypt}
\item 
\mbox{\Hypertarget{class_supervision__qobject_aa89f982e88704f5d06c7505c06589c82}\label{class_supervision__qobject_aa89f982e88704f5d06c7505c06589c82}} 
Q\+String {\bfseries interface\+\_\+name}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a384a1d1ee7fd84a207e3625b1360086d}\label{class_supervision__qobject_a384a1d1ee7fd84a207e3625b1360086d}} 
Q\+Host\+Address {\bfseries ip}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a31f194ce95c36a29f1e19e2dd770a9ae}\label{class_supervision__qobject_a31f194ce95c36a29f1e19e2dd770a9ae}} 
int {\bfseries badge\+\_\+db\+\_\+etat}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a6679e301c2a1eeebe055d1d7726fd46d}\label{class_supervision__qobject_a6679e301c2a1eeebe055d1d7726fd46d}} 
int {\bfseries http\+\_\+etat}
\item 
\mbox{\Hypertarget{class_supervision__qobject_af391bfc62366b3ce7e7b01e6ec0841ff}\label{class_supervision__qobject_af391bfc62366b3ce7e7b01e6ec0841ff}} 
Q\+String {\bfseries http\+\_\+server}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a71207d1087d19fed53164882bebcd6f7}\label{class_supervision__qobject_a71207d1087d19fed53164882bebcd6f7}} 
Q\+String {\bfseries http\+\_\+port\+\_\+https}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a0a7075e24050a63a6b600512f4911a8c}\label{class_supervision__qobject_a0a7075e24050a63a6b600512f4911a8c}} 
Q\+String {\bfseries http\+\_\+port\+\_\+http}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a12ee2bb679d5d7466792119336c0a919}\label{class_supervision__qobject_a12ee2bb679d5d7466792119336c0a919}} 
Q\+String {\bfseries http\+\_\+service}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a8ac8e76dc2306dbe56ee499a8b17a683}\label{class_supervision__qobject_a8ac8e76dc2306dbe56ee499a8b17a683}} 
Q\+String {\bfseries http\+\_\+user}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a3da4ac8dcc83c0af2bedb591eea939a3}\label{class_supervision__qobject_a3da4ac8dcc83c0af2bedb591eea939a3}} 
Q\+String {\bfseries http\+\_\+password}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a50b8034cd8fbd430bee3a1dcff40e776}\label{class_supervision__qobject_a50b8034cd8fbd430bee3a1dcff40e776}} 
Q\+String {\bfseries http\+\_\+timeout}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a51f48e0f9da59423abc1e23fd0cfb52f}\label{class_supervision__qobject_a51f48e0f9da59423abc1e23fd0cfb52f}} 
int {\bfseries http\+\_\+erreurs}
\item 
\mbox{\Hypertarget{class_supervision__qobject_ae13fc1c2514ad6604f79c32c6492bf97}\label{class_supervision__qobject_ae13fc1c2514ad6604f79c32c6492bf97}} 
Q\+String {\bfseries time2bii\+\_\+name}
\end{DoxyCompactItemize}
\doxysubsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a6a9dde18a036a688b16dd540951c7b97}\label{class_supervision__qobject_a6a9dde18a036a688b16dd540951c7b97}} 
static \mbox{\hyperlink{class_supervision__qobject}{Supervision\+\_\+qobject}} $\ast$ {\bfseries instance} = 0
\item 
\mbox{\Hypertarget{class_supervision__qobject_a422017f03fe18f4498bee487ea88d35e}\label{class_supervision__qobject_a422017f03fe18f4498bee487ea88d35e}} 
static const Q\+String {\bfseries version\+\_\+logiciel\+\_\+i} =\char`\"{}Smartime 2.\+0.\+1\char`\"{}
\end{DoxyCompactItemize}
\doxysubsection*{Private Slots}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{priv\+\_\+trigger}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{Supervision\+\_\+qobject\+::priv\+\_\+trigger}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}{provide\+Authentication}} (Q\+Network\+Reply $\ast$reply, Q\+Authenticator $\ast$ator)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}{Supervision\+\_\+qobject\+::provide\+Authentication}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}{finished\+Slot}} (Q\+Network\+Reply $\ast$reply)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}{Supervision\+\_\+qobject\+::finished\+Slot}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_af9f5951af6651fdefa1c886b77bac292}{supervision\+\_\+init0}} (void)
\begin{DoxyCompactList}\small\item\em init de l\textquotesingle{}objet \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{priv\+\_\+restart\+\_\+reseau}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{Supervision\+\_\+qobject\+::priv\+\_\+restart\+\_\+reseau}}. \end{DoxyCompactList}\item 
Q\+String \mbox{\hyperlink{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}{priv\+\_\+supervision\+\_\+test\+\_\+interface}} ()
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}{Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+interface}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{priv\+\_\+supervision\+\_\+test\+\_\+ip}} ()
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+ip}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{priv\+\_\+attente\+\_\+ip}} (int ok)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{Supervision\+\_\+qobject\+::priv\+\_\+attente\+\_\+ip}}. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}{attente\+\_\+ssl\+\_\+certificat}} (void)
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}{Supervision\+\_\+qobject\+::attente\+\_\+ssl\+\_\+certificat}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
quint32 \mbox{\hyperlink{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}{next\+Id\+Post}} ()
\begin{DoxyCompactList}\small\item\em \mbox{\hyperlink{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}{Supervision\+\_\+qobject\+::next\+Id\+Post}}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a13df7dee5ccaa76a295d5781ff184504}\label{class_supervision__qobject_a13df7dee5ccaa76a295d5781ff184504}} 
Q\+Sql\+Database {\bfseries badge\+\_\+db}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a074374b2710b5b6d89f786473f3c936d}\label{class_supervision__qobject_a074374b2710b5b6d89f786473f3c936d}} 
Q\+Network\+Access\+Manager $\ast$ {\bfseries manager}
\item 
\mbox{\Hypertarget{class_supervision__qobject_af4910f43167675377fe203ab2fb9afc1}\label{class_supervision__qobject_af4910f43167675377fe203ab2fb9afc1}} 
Q\+Network\+Reply $\ast$ {\bfseries networkreply}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a6cad2d03542e0ef1009f63f3415af646}\label{class_supervision__qobject_a6cad2d03542e0ef1009f63f3415af646}} 
Q\+Network\+Request $\ast$ {\bfseries request}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a4a6f328a0458a561e55f1f203cab073c}\label{class_supervision__qobject_a4a6f328a0458a561e55f1f203cab073c}} 
Q\+Ssl\+Configuration $\ast$ {\bfseries Ssl\+Configuration}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a704df42fc07742318f0103904dcee2db}\label{class_supervision__qobject_a704df42fc07742318f0103904dcee2db}} 
Q\+Timer {\bfseries timerloop}
\item 
\mbox{\Hypertarget{class_supervision__qobject_aa626e45681402f3ffb43607b672f76e3}\label{class_supervision__qobject_aa626e45681402f3ffb43607b672f76e3}} 
quint32 {\bfseries id\+Post}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a8a43ef34fcf361be47234502d43b6b96}\label{class_supervision__qobject_a8a43ef34fcf361be47234502d43b6b96}} 
Q\+Cache$<$ quint32, \mbox{\hyperlink{structbadgeage}{badgeage}} $>$ {\bfseries badge\+Cache}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a7491fcf390d5eb04b238e2869c13b5fc}\label{class_supervision__qobject_a7491fcf390d5eb04b238e2869c13b5fc}} 
Q\+Timer $\ast$ {\bfseries Stimer}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a16217fa1f0d13202e786d04bec99c5d9}\label{class_supervision__qobject_a16217fa1f0d13202e786d04bec99c5d9}} 
Q\+Url {\bfseries url}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a2a8dc45d2adccef796ba801ebfb73139}\label{class_supervision__qobject_a2a8dc45d2adccef796ba801ebfb73139}} 
Q\+File {\bfseries ssl\+\_\+certificat}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a4f59f22f57c8357a0177062041c1718d}\label{class_supervision__qobject_a4f59f22f57c8357a0177062041c1718d}} 
Q\+String {\bfseries reply\+\_\+string}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a19c49da7919a339f74f9b1e0040250a2}\label{class_supervision__qobject_a19c49da7919a339f74f9b1e0040250a2}} 
int {\bfseries time\+\_\+out}
\item 
\mbox{\Hypertarget{class_supervision__qobject_a2de56f16c35d6b6c58933d09fa27ec7a}\label{class_supervision__qobject_a2de56f16c35d6b6c58933d09fa27ec7a}} 
int {\bfseries http\+\_\+initok}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
The \mbox{\hyperlink{class_supervision__qobject}{Supervision\+\_\+qobject}} class. 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}\label{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}} 
\index{Supervision\_qobject@{Supervision\_qobject}!attente\_ssl\_certificat@{attente\_ssl\_certificat}}
\index{attente\_ssl\_certificat@{attente\_ssl\_certificat}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{attente\_ssl\_certificat}{attente\_ssl\_certificat}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::attente\+\_\+ssl\+\_\+certificat (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}{Supervision\+\_\+qobject\+::attente\+\_\+ssl\+\_\+certificat}}. 


\begin{DoxyItemize}
\item Gestion des serveur https 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{262 \{}
\DoxyCodeLine{263     supervisionlog-\/>debug(\textcolor{stringliteral}{"attente\_ssl\_certificat"});}
\DoxyCodeLine{264     QString tmp;}
\DoxyCodeLine{265 \textcolor{comment}{/*    if (!http\_port\_https.isEmpty())}}
\DoxyCodeLine{266 \textcolor{comment}{    \{}}
\DoxyCodeLine{267 \textcolor{comment}{  */}  \textcolor{keywordtype}{int} i=0;}
\DoxyCodeLine{268     \textcolor{keywordflow}{while}(!ssl\_certificat.size())}
\DoxyCodeLine{269         \{}
\DoxyCodeLine{270          QProcess *qProc= \textcolor{keyword}{new} QProcess(\textcolor{keyword}{this});}
\DoxyCodeLine{271          QString b= QString(\textcolor{stringliteral}{"openssl s\_client -\/showcerts -\/connect \%1:\%2 "}).arg(http\_server).arg(http\_port\_https).toLatin1();}
\DoxyCodeLine{272          supervisionlog-\/>debug(\textcolor{stringliteral}{"openssl : "} + b.toStdString());}
\DoxyCodeLine{273          qProc-\/>start(b);}
\DoxyCodeLine{274          qProc-\/>waitForReadyRead(2000);}
\DoxyCodeLine{275          tmp = qProc-\/>readAll();}
\DoxyCodeLine{276 }
\DoxyCodeLine{277          ssl\_certificat.open(QIODevice::WriteOnly | QIODevice::Text);}
\DoxyCodeLine{278          ssl\_certificat.write(tmp.toLatin1());}
\DoxyCodeLine{279          ssl\_certificat.close();}
\DoxyCodeLine{280          qProc-\/>close();}
\DoxyCodeLine{281          qProc-\/>deleteLater();}
\DoxyCodeLine{282          supervisionlog-\/>debug(\textcolor{stringliteral}{"attente de certificat:"}+tmp.toStdString());}
\DoxyCodeLine{283 }
\DoxyCodeLine{284          \textcolor{keywordflow}{if} (tmp.isEmpty())}
\DoxyCodeLine{285          \{}
\DoxyCodeLine{286              i++;}
\DoxyCodeLine{287              \textcolor{keywordflow}{if} (i >3)}
\DoxyCodeLine{288              \{}
\DoxyCodeLine{289                  http\_port\_https.clear();}
\DoxyCodeLine{290                  \textcolor{keywordflow}{return};}
\DoxyCodeLine{291              \}}
\DoxyCodeLine{292          \}}
\DoxyCodeLine{293         \textcolor{comment}{// QTest::qWait(1000);  // event processing}}
\DoxyCodeLine{294      \}}
\DoxyCodeLine{295 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_afea58f3259299107ede363a74a5e0110}\label{class_supervision__qobject_afea58f3259299107ede363a74a5e0110}} 
\index{Supervision\_qobject@{Supervision\_qobject}!customEvent@{customEvent}}
\index{customEvent@{customEvent}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{customEvent()}{customEvent()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::custom\+Event (\begin{DoxyParamCaption}\item[{Q\+Event $\ast$}]{event }\end{DoxyParamCaption})}



(N\+OT U\+S\+ED) \mbox{\hyperlink{class_supervision__qobject_afea58f3259299107ede363a74a5e0110}{Supervision\+\_\+qobject\+::custom\+Event}} 


\begin{DoxyParams}{Parameters}
{\em event} & \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{852 \{}
\DoxyCodeLine{853     \textcolor{keywordflow}{if}(T2bEvent::custom\_type()== event-\/>type())}
\DoxyCodeLine{854     \{}
\DoxyCodeLine{855         \mbox{\hyperlink{class_t2b_event}{T2bEvent}} *e = (\mbox{\hyperlink{class_t2b_event}{T2bEvent}} *)event;}
\DoxyCodeLine{856 }
\DoxyCodeLine{857         \textcolor{keywordflow}{switch} (e-\/>eventType())}
\DoxyCodeLine{858         \{}
\DoxyCodeLine{859 }
\DoxyCodeLine{860             \textcolor{keywordflow}{case} EventType::BADGE\_UPDATE\_NOM:}
\DoxyCodeLine{861                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{862             \textcolor{keywordflow}{default}:}
\DoxyCodeLine{863                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{864 }
\DoxyCodeLine{865         \}}
\DoxyCodeLine{866     \}}
\DoxyCodeLine{867 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}\label{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}} 
\index{Supervision\_qobject@{Supervision\_qobject}!demarreTrigger@{demarreTrigger}}
\index{demarreTrigger@{demarreTrigger}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{demarreTrigger()}{demarreTrigger()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::demarre\+Trigger (\begin{DoxyParamCaption}\item[{int}]{high = {\ttfamily 10},  }\item[{int}]{low = {\ttfamily 1} }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{Supervision\+\_\+qobject\+::demarre\+Trigger}}. 


\begin{DoxyItemize}
\item à l\textquotesingle{}init demarrage du premier trigger aléatoirement entre 1 et 10 secondes.
\item appelé par \mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{supervision\+\_\+init\+\_\+http()}}
\item appel \mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{priv\+\_\+trigger()}} (Stimer-\/$>$start) 
\begin{DoxyParams}{Parameters}
{\em high} & \\
\hline
{\em low} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{136 \{}
\DoxyCodeLine{137     \textcolor{comment}{// demarrage du premier trigger aléatoirement entre 1 et 10 secondes.}}
\DoxyCodeLine{138     \textcolor{keywordflow}{if}(high < low)}
\DoxyCodeLine{139     \{}
\DoxyCodeLine{140         \textcolor{keywordtype}{int} i = low;}
\DoxyCodeLine{141         low = high;}
\DoxyCodeLine{142         high = i;}
\DoxyCodeLine{143     \}}
\DoxyCodeLine{144     qsrand(QDateTime::currentMSecsSinceEpoch() / 1000);}
\DoxyCodeLine{145     \textcolor{keywordtype}{int} st = 1000 * (qrand() \% ((high + 1) -\/ low) + low);}
\DoxyCodeLine{146     Stimer-\/>start(st); \textcolor{comment}{//appel priv\_trigger()}}
\DoxyCodeLine{147 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}\label{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}} 
\index{Supervision\_qobject@{Supervision\_qobject}!encode\_string@{encode\_string}}
\index{encode\_string@{encode\_string}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{encode\_string()}{encode\_string()}}
{\footnotesize\ttfamily Q\+Byte\+Array Supervision\+\_\+qobject\+::encode\+\_\+string (\begin{DoxyParamCaption}\item[{Q\+Byte\+Array}]{s }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{Supervision\+\_\+qobject\+::encode\+\_\+string}}. 


\begin{DoxyParams}{Parameters}
{\em s} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{760 \{}
\DoxyCodeLine{761     supervisionlog-\/>debug(\textcolor{stringliteral}{"encode\_string"});}
\DoxyCodeLine{762 }
\DoxyCodeLine{763   \textcolor{keywordflow}{if} (key\_crypt.isEmpty())  \textcolor{keywordflow}{return}(s.toBase64());}
\DoxyCodeLine{764   \textcolor{keywordflow}{else}}
\DoxyCodeLine{765     \{}
\DoxyCodeLine{766     \textcolor{keyword}{using namespace }CryptoPP;}
\DoxyCodeLine{767     \mbox{\hyperlink{class_encryption}{Encryption}} *encry = \textcolor{keyword}{new} \mbox{\hyperlink{class_encryption}{Encryption}}();}
\DoxyCodeLine{768     \textcolor{comment}{//FIXME fuite mémoire ici}}
\DoxyCodeLine{769     \textcolor{keywordtype}{string} msg= encry-\/>encryption(key\_crypt, QString(s), \textcolor{stringliteral}{"AES\_base64"}, \textcolor{keyword}{true});}
\DoxyCodeLine{770     QString b= QString::fromStdString(msg);}
\DoxyCodeLine{771     \textcolor{keywordflow}{return}(b.toLatin1());}
\DoxyCodeLine{772     \}}
\DoxyCodeLine{773 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}\label{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}} 
\index{Supervision\_qobject@{Supervision\_qobject}!finishedSlot@{finishedSlot}}
\index{finishedSlot@{finishedSlot}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{finishedSlot}{finishedSlot}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::finished\+Slot (\begin{DoxyParamCaption}\item[{Q\+Network\+Reply $\ast$}]{reply }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}{Supervision\+\_\+qobject\+::finished\+Slot}}. 


\begin{DoxyItemize}
\item appelé par \mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{priv\+\_\+trigger()}} avec le manager post request
\item appel \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\+\_\+http\+\_\+status()}} pour affichage logo alerte si pas d\textquotesingle{}erreur
\item si il y avait des badgeage en cache on les supprime de database\+\_\+setup.\+db
\item appel au \mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{priv\+\_\+trigger()}} Stimer-\/$>$start pour un nouveau trigger dans 90secs 
\begin{DoxyParams}{Parameters}
{\em reply} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{464 \{}
\DoxyCodeLine{465     \textcolor{comment}{// no error received?}}
\DoxyCodeLine{466     supervisionlog-\/>debug(\textcolor{stringliteral}{"finishedSlot"});}
\DoxyCodeLine{467     \textcolor{keywordtype}{bool} erreur = \textcolor{keyword}{true};}
\DoxyCodeLine{468     \textcolor{comment}{//demarrage du trigger dans 90 secondes}}
\DoxyCodeLine{469     \textcolor{keywordtype}{int} tt = 90*1000;}
\DoxyCodeLine{470 }
\DoxyCodeLine{471     \textcolor{comment}{// Test si la réponse c'est bien déroulé.}}
\DoxyCodeLine{472     \textcolor{keywordflow}{if} (reply-\/>error() == QNetworkReply::NoError)}
\DoxyCodeLine{473     \{}
\DoxyCodeLine{474 }
\DoxyCodeLine{475         supervisionlog-\/>debug(\textcolor{stringliteral}{"Test réseau, QNetworkReply::NoError"});}
\DoxyCodeLine{476         QVariant statusCodeV = reply-\/>attribute(QNetworkRequest::HttpStatusCodeAttribute);}
\DoxyCodeLine{477         supervisionlog-\/>debug(\textcolor{stringliteral}{"Test réseau, QNetworkRequest reply : \%d"}, statusCodeV.toInt());}
\DoxyCodeLine{478         \textcolor{keywordflow}{if} (statusCodeV.toInt() >=200 \&\& statusCodeV.toInt() < 300 )}
\DoxyCodeLine{479         \{            }
\DoxyCodeLine{480             QString rst(reply-\/>readAll());}
\DoxyCodeLine{481             \textcolor{keywordflow}{if} (rst.contains(\textcolor{stringliteral}{"OK"}))}
\DoxyCodeLine{482             \{}
\DoxyCodeLine{483                 erreur = \textcolor{keyword}{false};}
\DoxyCodeLine{484             \}}
\DoxyCodeLine{485         \}}
\DoxyCodeLine{486     \}}
\DoxyCodeLine{487     supervisionlog-\/>debug(\textcolor{stringliteral}{"Test réseau, erreur : \%d"}, erreur);}
\DoxyCodeLine{488     \textcolor{keywordflow}{if}(erreur)}
\DoxyCodeLine{489     \{}
\DoxyCodeLine{490         \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(-\/1); \textcolor{comment}{//affichage du logo alerte\_http}}
\DoxyCodeLine{491         http\_erreurs++;}
\DoxyCodeLine{492     \}}
\DoxyCodeLine{493     \textcolor{keywordflow}{else}}
\DoxyCodeLine{494     \{}
\DoxyCodeLine{495         http\_erreurs=0;}
\DoxyCodeLine{496         \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(1); \textcolor{comment}{//suppression du logo alerte\_http}}
\DoxyCodeLine{497     \}}
\DoxyCodeLine{498 }
\DoxyCodeLine{499     \textcolor{comment}{// cas d'un badgeage.}}
\DoxyCodeLine{500     \textcolor{keywordflow}{if} (reply-\/>property(\textcolor{stringliteral}{"idBadgeage"}).isValid())}
\DoxyCodeLine{501     \{}
\DoxyCodeLine{502         supervisionlog-\/>debug(\textcolor{stringliteral}{"c'est un badgeage"});}
\DoxyCodeLine{503         \textcolor{keywordtype}{int} \textcolor{keywordtype}{id} = reply-\/>property(\textcolor{stringliteral}{"idBadgeage"}).toInt();}
\DoxyCodeLine{504         \textcolor{keywordflow}{if}(badgeCache.contains(\textcolor{keywordtype}{id}))}
\DoxyCodeLine{505         \{}
\DoxyCodeLine{506             \mbox{\hyperlink{structbadgeage}{badgeage}} *b = badgeCache[id];}
\DoxyCodeLine{507             \textcolor{keywordflow}{if}(b-\/>dbKey != 0)}
\DoxyCodeLine{508             \{}
\DoxyCodeLine{509                 supervisionlog-\/>debug(\textcolor{stringliteral}{"badge en cache"});}
\DoxyCodeLine{510                 \textcolor{comment}{//le badge est en base de donnée.}}
\DoxyCodeLine{511                 \textcolor{keywordflow}{if}(badge\_db.open())}
\DoxyCodeLine{512                 \{}
\DoxyCodeLine{513                     \textcolor{keywordtype}{int} nb = 0;}
\DoxyCodeLine{514                     QSqlQuery query(QString(\textcolor{stringliteral}{"SELECT count(*) from badge where key=\%1"}).arg(b-\/>dbKey),badge\_db);}
\DoxyCodeLine{515                     \textcolor{keywordflow}{if}(query.next())}
\DoxyCodeLine{516                     \{}
\DoxyCodeLine{517                         supervisionlog-\/>debug(\textcolor{stringliteral}{"badge sauvegardé"});}
\DoxyCodeLine{518                         nb = query.value(0).toInt();}
\DoxyCodeLine{519                     \}}
\DoxyCodeLine{520 }
\DoxyCodeLine{521                     \textcolor{keywordflow}{if}(erreur == \textcolor{keyword}{false})}
\DoxyCodeLine{522                     \{}
\DoxyCodeLine{523                         \textcolor{keywordflow}{if}(nb!=0)}
\DoxyCodeLine{524                         \{}
\DoxyCodeLine{525                             supervisionlog-\/>debug(\textcolor{stringliteral}{"on efface le badge dans la bdd "});}
\DoxyCodeLine{526                             query.exec(QString(\textcolor{stringliteral}{"delete from badge where key=\%1"}).arg(b-\/>dbKey));}
\DoxyCodeLine{527                             \textcolor{keywordflow}{if} (query.lastError().type() != 0)}
\DoxyCodeLine{528                                 \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(0); \textcolor{comment}{//affichage logo database}}
\DoxyCodeLine{529                             \textcolor{keywordflow}{else}}
\DoxyCodeLine{530                             \{}
\DoxyCodeLine{531                                 \textcolor{comment}{//on continue a envoyer les badges sauvegardés toute les 10 ms.}}
\DoxyCodeLine{532                                 tt = 10;}
\DoxyCodeLine{533                                 \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(1); \textcolor{comment}{//pas de logo database}}
\DoxyCodeLine{534                             \}}
\DoxyCodeLine{535                         \}}
\DoxyCodeLine{536                     \}}
\DoxyCodeLine{537                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{538                     \{}
\DoxyCodeLine{539                         supervisionlog-\/>debug(\textcolor{stringliteral}{"on n'efface pas y a un problème"});}
\DoxyCodeLine{540                         \textcolor{comment}{//on ne supprime pas le badgeage car il y a une erreur.}}
\DoxyCodeLine{541                     \}}
\DoxyCodeLine{542                     badge\_db.close();}
\DoxyCodeLine{543                 \}}
\DoxyCodeLine{544             \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{545             \{}
\DoxyCodeLine{546                 \textcolor{comment}{//badge n'est pas en base}}
\DoxyCodeLine{547                 supervisionlog-\/>debug(\textcolor{stringliteral}{"finishedSlot badge n'est pas en base"});}
\DoxyCodeLine{548                 \textcolor{keywordflow}{if}(erreur == \textcolor{keyword}{true})}
\DoxyCodeLine{549                 \{}
\DoxyCodeLine{550                     \textcolor{comment}{//il y a eu une erreur dans la réponse, on sauvegarde le badge.}}
\DoxyCodeLine{551                     supervisionlog-\/>debug(\textcolor{stringliteral}{"ya un bug. on sauvegarde le badgeage"});}
\DoxyCodeLine{552                     \mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{sauvegardeBadge}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{553                 \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{554                 \{}
\DoxyCodeLine{555                     \textcolor{keywordflow}{if}(badge\_db.open())}
\DoxyCodeLine{556                     \{}
\DoxyCodeLine{557                         \textcolor{keywordtype}{int} nb = 0;}
\DoxyCodeLine{558                         QSqlQuery query(QString(\textcolor{stringliteral}{"SELECT count(*) from badge"}),badge\_db);}
\DoxyCodeLine{559                         \textcolor{keywordflow}{if}(query.next())}
\DoxyCodeLine{560                         \{}
\DoxyCodeLine{561                             supervisionlog-\/>debug(\textcolor{stringliteral}{"badge sauvegardé"});}
\DoxyCodeLine{562                             nb = query.value(0).toInt();}
\DoxyCodeLine{563                             \textcolor{keywordflow}{if}(nb!=0)}
\DoxyCodeLine{564                             \{}
\DoxyCodeLine{565                                 tt=10;}
\DoxyCodeLine{566                             \}}
\DoxyCodeLine{567                         \}}
\DoxyCodeLine{568                         badge\_db.close();}
\DoxyCodeLine{569                     \}}
\DoxyCodeLine{570                     \textcolor{comment}{//le badgeage a bien été envoyé on ne le sauvegarde pas.}}
\DoxyCodeLine{571                     supervisionlog-\/>debug(\textcolor{stringliteral}{"le badgeage est ok"});}
\DoxyCodeLine{572                 \}}
\DoxyCodeLine{573 }
\DoxyCodeLine{574 }
\DoxyCodeLine{575             \}}
\DoxyCodeLine{576         \}\textcolor{keywordflow}{else}}
\DoxyCodeLine{577         \{}
\DoxyCodeLine{578             \textcolor{comment}{//Une réponse d'un badge que je ne connais pas ? un doublon ?}}
\DoxyCodeLine{579             supervisionlog-\/>debug(\textcolor{stringliteral}{"c'est quoi ce bins"});}
\DoxyCodeLine{580         \}}
\DoxyCodeLine{581     \}\textcolor{keywordflow}{else} \textcolor{comment}{//pas de badgeage en cache}}
\DoxyCodeLine{582     \{}
\DoxyCodeLine{583         \textcolor{comment}{//ce n'est pas un badgeage. un trigger ?}}
\DoxyCodeLine{584         supervisionlog-\/>debug(\textcolor{stringliteral}{"a voilà le trigger"});}
\DoxyCodeLine{585     \}}
\DoxyCodeLine{586 }
\DoxyCodeLine{587     \textcolor{comment}{//demarrage du trigger dans tt secondes}}
\DoxyCodeLine{588     Stimer-\/>start(tt);}
\DoxyCodeLine{589     reply-\/>deleteLater();}
\DoxyCodeLine{590 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_aa72329b1b5f3e30906561ea49224dcaa}\label{class_supervision__qobject_aa72329b1b5f3e30906561ea49224dcaa}} 
\index{Supervision\_qobject@{Supervision\_qobject}!getInstance@{getInstance}}
\index{getInstance@{getInstance}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{getInstance()}{getInstance()}}
{\footnotesize\ttfamily \mbox{\hyperlink{class_supervision__qobject}{Supervision\+\_\+qobject}} $\ast$ Supervision\+\_\+qobject\+::get\+Instance (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



\mbox{\hyperlink{class_supervision__qobject_aa72329b1b5f3e30906561ea49224dcaa}{Supervision\+\_\+qobject\+::get\+Instance}}. 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{37 \{}
\DoxyCodeLine{38     supervisionlog-\/>debug(\textcolor{stringliteral}{"getInstance"});}
\DoxyCodeLine{39     \textcolor{keywordflow}{if} ( !Supervision\_qobject::instance )}
\DoxyCodeLine{40     \{}
\DoxyCodeLine{41         \mbox{\hyperlink{class_supervision__qobject}{Supervision\_qobject}} * supervision = \textcolor{keyword}{new} \mbox{\hyperlink{class_supervision__qobject_af5f668f55d568f996800c348e4b7b10d}{Supervision\_qobject}}();}
\DoxyCodeLine{42         Supervision\_qobject::instance = supervision;}
\DoxyCodeLine{43     \}}
\DoxyCodeLine{44 }
\DoxyCodeLine{45     \textcolor{keywordflow}{return} Supervision\_qobject::instance;}
\DoxyCodeLine{46 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a864bf60af5bfa0bb83f7ed98518fe0ed}\label{class_supervision__qobject_a864bf60af5bfa0bb83f7ed98518fe0ed}} 
\index{Supervision\_qobject@{Supervision\_qobject}!getTime2bii\_name@{getTime2bii\_name}}
\index{getTime2bii\_name@{getTime2bii\_name}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{getTime2bii\_name()}{getTime2bii\_name()}}
{\footnotesize\ttfamily Q\+String Supervision\+\_\+qobject\+::get\+Time2bii\+\_\+name (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) const}



\mbox{\hyperlink{class_supervision__qobject_a864bf60af5bfa0bb83f7ed98518fe0ed}{Supervision\+\_\+qobject\+::get\+Time2bii\+\_\+name}}. 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{780 \{}
\DoxyCodeLine{781     supervisionlog-\/>debug(\textcolor{stringliteral}{"getTime2bii\_name"});}
\DoxyCodeLine{782     \textcolor{keywordflow}{return} time2bii\_name;}
\DoxyCodeLine{783 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ad2afdb21031a6ab2fe480cb57c9291e7}\label{class_supervision__qobject_ad2afdb21031a6ab2fe480cb57c9291e7}} 
\index{Supervision\_qobject@{Supervision\_qobject}!ihm\_post\_badge@{ihm\_post\_badge}}
\index{ihm\_post\_badge@{ihm\_post\_badge}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{ihm\_post\_badge}{ihm\_post\_badge}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::ihm\+\_\+post\+\_\+badge (\begin{DoxyParamCaption}\item[{Q\+String}]{badge,  }\item[{Q\+String}]{j,  }\item[{Q\+String}]{h,  }\item[{Q\+String}]{activite }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_ad2afdb21031a6ab2fe480cb57c9291e7}{Supervision\+\_\+qobject\+::ihm\+\_\+post\+\_\+badge}}. 


\begin{DoxyItemize}
\item appelé par signal\+\_\+supervision\+\_\+ihm\+\_\+post\+\_\+badge quand un badgeage survient (\mbox{\hyperlink{class_x7_lecteur_r_f_ac524f8ca16720eae8e87cdb6a8c9e1f9}{X7\+Lecteur\+R\+F\+::recoit\+Data\+Du\+Port()}})
\item appel \mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{sauvegarde\+Badge()}} 
\begin{DoxyParams}{Parameters}
{\em badge} & \\
\hline
{\em j} & \\
\hline
{\em h} & \\
\hline
{\em activite} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{682 \{}
\DoxyCodeLine{683     supervisionlog-\/>debug(\textcolor{stringliteral}{"ihm\_post\_badge"});}
\DoxyCodeLine{684     QTime t = QTime::fromString(h, Qt::TextDate);}
\DoxyCodeLine{685     QDate d = QDate::fromString(j, Qt::ISODate);}
\DoxyCodeLine{686     QDateTime dt(d,t);}
\DoxyCodeLine{687     supervisionlog-\/>debug(\textcolor{stringliteral}{"badgeage : \%s \%s \%s \%s"}, badge, j, h, activite);}
\DoxyCodeLine{688     \mbox{\hyperlink{structbadgeage}{badgeage}} *b = \textcolor{keyword}{new} \mbox{\hyperlink{structbadgeage}{badgeage}}(badge,dt,activite,0);}
\DoxyCodeLine{689 }
\DoxyCodeLine{690     quint32 \textcolor{keywordtype}{id} = \mbox{\hyperlink{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}{nextIdPost}}();}
\DoxyCodeLine{691     badgeCache.insert(\textcolor{keywordtype}{id},b);}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     \textcolor{keywordflow}{if} (!http\_server.isEmpty() \&\& http\_initok==1 \&\& !(ip.isNull()) )}
\DoxyCodeLine{694     \{}
\DoxyCodeLine{695         QString s=QString::number(QDateTime::currentMSecsSinceEpoch());}
\DoxyCodeLine{696         s.append(\textcolor{stringliteral}{" "}+b-\/>toString()+\textcolor{stringliteral}{" "}+time2bii\_name+\textcolor{stringliteral}{" "}+ ip.toString()+\textcolor{stringliteral}{" "}+\textcolor{stringliteral}{"T"});}
\DoxyCodeLine{697 }
\DoxyCodeLine{698         QByteArray s1=\mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{encode\_string}}(s.toLatin1());}
\DoxyCodeLine{699         s1.insert(0,\textcolor{stringliteral}{"id="});}
\DoxyCodeLine{700         supervisionlog-\/>debug(\textcolor{stringliteral}{"badgeage : "}+s1);}
\DoxyCodeLine{701 }
\DoxyCodeLine{702         QNetworkReply *reply =manager-\/>post(*request,s1);}
\DoxyCodeLine{703         reply-\/>setProperty(\textcolor{stringliteral}{"idBadgeage"}, \textcolor{keywordtype}{id});}
\DoxyCodeLine{704     \}}
\DoxyCodeLine{705     \textcolor{keywordflow}{else}}
\DoxyCodeLine{706     \{}
\DoxyCodeLine{707         \mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{sauvegardeBadge}}(\textcolor{keywordtype}{id});}
\DoxyCodeLine{708     \}}
\DoxyCodeLine{709 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}\label{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}} 
\index{Supervision\_qobject@{Supervision\_qobject}!nextIdPost@{nextIdPost}}
\index{nextIdPost@{nextIdPost}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{nextIdPost()}{nextIdPost()}}
{\footnotesize\ttfamily quint32 Supervision\+\_\+qobject\+::next\+Id\+Post (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



\mbox{\hyperlink{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}{Supervision\+\_\+qobject\+::next\+Id\+Post}}. 

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{449 \{}
\DoxyCodeLine{450     idPost++;}
\DoxyCodeLine{451     \textcolor{keywordflow}{return} idPost;}
\DoxyCodeLine{452 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}\label{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}} 
\index{Supervision\_qobject@{Supervision\_qobject}!priv\_attente\_ip@{priv\_attente\_ip}}
\index{priv\_attente\_ip@{priv\_attente\_ip}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{priv\_attente\_ip}{priv\_attente\_ip}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::priv\+\_\+attente\+\_\+ip (\begin{DoxyParamCaption}\item[{int}]{ok }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{Supervision\+\_\+qobject\+::priv\+\_\+attente\+\_\+ip}}. 


\begin{DoxyItemize}
\item recherche adresse ip
\item appel \mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{priv\+\_\+restart\+\_\+reseau()}} redémarrage reseau wlan
\item appel \mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{priv\+\_\+supervision\+\_\+test\+\_\+ip()}} recherche adresse ip 
\begin{DoxyParams}{Parameters}
{\em ok} & 0-\/recherche adresse ip, 1-\/redemarrage interface réseau puis recherche ip \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{425 \{}
\DoxyCodeLine{426     \textcolor{keywordtype}{int} b=0;}
\DoxyCodeLine{427     \textcolor{keywordflow}{if}(ok) \mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{priv\_restart\_reseau}}(); \textcolor{comment}{//redemarrage interface réseau}}
\DoxyCodeLine{428     \mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{priv\_supervision\_test\_ip}}(); \textcolor{comment}{//Met à jour variable ip}}
\DoxyCodeLine{429 }
\DoxyCodeLine{430     \textcolor{keywordflow}{while} (ip.isNull())}
\DoxyCodeLine{431     \{}
\DoxyCodeLine{432         \textcolor{keywordflow}{if} (b++ >10)\textcolor{comment}{//on redémarre le reseau pour la bieme fois}}
\DoxyCodeLine{433         \{}
\DoxyCodeLine{434             supervisionlog-\/>debug(\textcolor{stringliteral}{"priv\_attente\_ip: b++ >10"});}
\DoxyCodeLine{435             b=0;}
\DoxyCodeLine{436             \mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{priv\_restart\_reseau}}(); \textcolor{comment}{//redemarrage interface réseau}}
\DoxyCodeLine{437         \}}
\DoxyCodeLine{438         \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(-\/1); \textcolor{comment}{//affichage du logo alerte\_http}}
\DoxyCodeLine{439         QTest::qWait(1000);  \textcolor{comment}{// event processing}}
\DoxyCodeLine{440         \mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{priv\_supervision\_test\_ip}}(); \textcolor{comment}{//Met à jour variable ip}}
\DoxyCodeLine{441     \}}
\DoxyCodeLine{442 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}\label{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}} 
\index{Supervision\_qobject@{Supervision\_qobject}!priv\_restart\_reseau@{priv\_restart\_reseau}}
\index{priv\_restart\_reseau@{priv\_restart\_reseau}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{priv\_restart\_reseau}{priv\_restart\_reseau}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::priv\+\_\+restart\+\_\+reseau (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_a92a91843c65e6824cc9a15ee2c5d853f}{Supervision\+\_\+qobject\+::priv\+\_\+restart\+\_\+reseau}}. 


\begin{DoxyItemize}
\item redemarrage reseau wlan
\item appel /etc/init.d/networking restart 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{305 \{}
\DoxyCodeLine{306     supervisionlog-\/>debug(\textcolor{stringliteral}{"priv\_restart\_reseau"});}
\DoxyCodeLine{307     \textcolor{keywordflow}{return}; \textcolor{comment}{//FIXME}}
\DoxyCodeLine{308     QString a;}
\DoxyCodeLine{309     http\_erreurs=0;}
\DoxyCodeLine{310     QProcess *qProc = \textcolor{keyword}{new} QProcess(\textcolor{keyword}{this});}
\DoxyCodeLine{311     a= QString(\textcolor{stringliteral}{"ip route del"});}
\DoxyCodeLine{312     qProc-\/>start(a);}
\DoxyCodeLine{313     qProc-\/>waitForReadyRead();}
\DoxyCodeLine{314     qProc-\/>readAll();}
\DoxyCodeLine{315     qProc-\/>close();}
\DoxyCodeLine{316     qProc-\/>deleteLater();}
\DoxyCodeLine{317 }
\DoxyCodeLine{318     supervisionlog-\/>debug(\textcolor{stringliteral}{"redemarrage reseau wlan"}) ;}
\DoxyCodeLine{319     QProcess *qProc1 = \textcolor{keyword}{new} QProcess(\textcolor{keyword}{this});}
\DoxyCodeLine{320     a= QString(\textcolor{stringliteral}{"/etc/init.d/networking restart"});}
\DoxyCodeLine{321     qProc1-\/>start(a);}
\DoxyCodeLine{322     QTest::qWait(1000);}
\DoxyCodeLine{323     \textcolor{keywordflow}{while} ( qProc1-\/>state()==QProcess::Running) QTest::qWait(100);}
\DoxyCodeLine{324     supervisionlog-\/>debug(\textcolor{stringliteral}{"Restart termine"});}
\DoxyCodeLine{325     qProc1-\/>close();}
\DoxyCodeLine{326     qProc1-\/>deleteLater();}
\DoxyCodeLine{327 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}\label{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}} 
\index{Supervision\_qobject@{Supervision\_qobject}!priv\_supervision\_test\_interface@{priv\_supervision\_test\_interface}}
\index{priv\_supervision\_test\_interface@{priv\_supervision\_test\_interface}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{priv\_supervision\_test\_interface}{priv\_supervision\_test\_interface}}
{\footnotesize\ttfamily Q\+String Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+interface (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}{Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+interface}}. 


\begin{DoxyItemize}
\item recherche les interfaces réseaux disponibles \begin{DoxyReturn}{Returns}

\end{DoxyReturn}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{335 \{}
\DoxyCodeLine{336     supervisionlog-\/>debug(\textcolor{stringliteral}{"priv\_supervision\_test\_interface"});}
\DoxyCodeLine{337     \textcolor{comment}{// test interface OK}}
\DoxyCodeLine{338     QList<QNetworkInterface> interfaces ;}
\DoxyCodeLine{339     QString interface\_name;}
\DoxyCodeLine{340     interface\_name.clear();}
\DoxyCodeLine{341     interfaces = QNetworkInterface::allInterfaces();}
\DoxyCodeLine{342     \textcolor{keywordflow}{foreach}(\textcolor{keyword}{const} QNetworkInterface \& interface, interfaces)}
\DoxyCodeLine{343     \{}
\DoxyCodeLine{344         \textcolor{keywordflow}{if} (interface.name().contains(\textcolor{stringliteral}{"eth"}) || interface.name().contains(\textcolor{stringliteral}{"wlan"}) || interface.name().contains(\textcolor{stringliteral}{"ppp"}))}
\DoxyCodeLine{345         \{}
\DoxyCodeLine{346             \textcolor{keywordflow}{if} (interface.flags() \& QNetworkInterface::IsUp)}
\DoxyCodeLine{347             \{}
\DoxyCodeLine{348                 \textcolor{keywordflow}{if} (interface.flags()  \& QNetworkInterface::IsRunning)}
\DoxyCodeLine{349                 \{}
\DoxyCodeLine{350                     interface\_name=interface.name();}
\DoxyCodeLine{351                 \}}
\DoxyCodeLine{352             \}}
\DoxyCodeLine{353         \}}
\DoxyCodeLine{354     \}}
\DoxyCodeLine{355 }
\DoxyCodeLine{356     \textcolor{keywordflow}{if} (interface\_name.contains(\textcolor{stringliteral}{"wlan"}) || interface\_name.contains(\textcolor{stringliteral}{"ppp"}))}
\DoxyCodeLine{357     \{}
\DoxyCodeLine{358         interfaces = QNetworkInterface::allInterfaces();}
\DoxyCodeLine{359         \textcolor{keywordflow}{foreach}(\textcolor{keyword}{const} QNetworkInterface \& interface, interfaces)}
\DoxyCodeLine{360         \{}
\DoxyCodeLine{361             \textcolor{keywordflow}{if} (interface.name().contains(\textcolor{stringliteral}{"eth"}))}
\DoxyCodeLine{362             \{}
\DoxyCodeLine{363                 \textcolor{keywordflow}{if} (interface.flags() \& QNetworkInterface::IsUp)}
\DoxyCodeLine{364                 \{}
\DoxyCodeLine{365                     QProcess *qProc = \textcolor{keyword}{new} QProcess(\textcolor{keyword}{this});}
\DoxyCodeLine{366                     QString a= QString(\textcolor{stringliteral}{"ifconfig eth0 down"});}
\DoxyCodeLine{367                     qProc-\/>start(a);}
\DoxyCodeLine{368                     qProc-\/>waitForReadyRead();}
\DoxyCodeLine{369                     qProc-\/>readAll();}
\DoxyCodeLine{370                     qProc-\/>close();}
\DoxyCodeLine{371                     qProc-\/>deleteLater();}
\DoxyCodeLine{372                 \}}
\DoxyCodeLine{373             \}}
\DoxyCodeLine{374         \}}
\DoxyCodeLine{375     \}}
\DoxyCodeLine{376     interfaces.clear();}
\DoxyCodeLine{377     \textcolor{keywordflow}{return}(interface\_name);}
\DoxyCodeLine{378 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_adb849555151f5c5567c27437691e4656}\label{class_supervision__qobject_adb849555151f5c5567c27437691e4656}} 
\index{Supervision\_qobject@{Supervision\_qobject}!priv\_supervision\_test\_ip@{priv\_supervision\_test\_ip}}
\index{priv\_supervision\_test\_ip@{priv\_supervision\_test\_ip}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{priv\_supervision\_test\_ip}{priv\_supervision\_test\_ip}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+ip (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_adb849555151f5c5567c27437691e4656}{Supervision\+\_\+qobject\+::priv\+\_\+supervision\+\_\+test\+\_\+ip}}. 


\begin{DoxyItemize}
\item recherche adresse ip
\item appel \mbox{\hyperlink{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}{priv\+\_\+supervision\+\_\+test\+\_\+interface()}}, recherche interfaces réseaux disponibles
\item appel signal\+\_\+x7\+Gest\+Config\+\_\+init\+\_\+mode\+\_\+network(), envoie infos réseaux à l\textquotesingle{}I\+HM 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{387 \{}
\DoxyCodeLine{388     \textcolor{comment}{// test adresse ip OK}}
\DoxyCodeLine{389     supervisionlog-\/>debug(\textcolor{stringliteral}{"priv\_supervision\_test\_ip"});}
\DoxyCodeLine{390     QList<QNetworkInterface> interfaces ;}
\DoxyCodeLine{391     QHostAddress val;}
\DoxyCodeLine{392 }
\DoxyCodeLine{393     QString interface\_name=\mbox{\hyperlink{class_supervision__qobject_ac2eff36eb89d4b385b2b732a1e3c8949}{priv\_supervision\_test\_interface}}();}
\DoxyCodeLine{394 }
\DoxyCodeLine{395     \textcolor{keywordflow}{if} (!interface\_name.isNull())}
\DoxyCodeLine{396     \{}
\DoxyCodeLine{397         interfaces = QNetworkInterface::allInterfaces();}
\DoxyCodeLine{398         \textcolor{keywordflow}{foreach}(\textcolor{keyword}{const} QNetworkInterface \& interface, interfaces)}
\DoxyCodeLine{399         \{}
\DoxyCodeLine{400             \textcolor{keywordflow}{if} (interface.name()==interface\_name)}
\DoxyCodeLine{401             \{}
\DoxyCodeLine{402                 QList<QNetworkAddressEntry> entries = interface.addressEntries();}
\DoxyCodeLine{403                 \textcolor{keywordflow}{if} (!entries.isEmpty())}
\DoxyCodeLine{404                 \{}
\DoxyCodeLine{405                     QNetworkAddressEntry entry = entries.first();}
\DoxyCodeLine{406                     val = entry.ip();}
\DoxyCodeLine{407                 \}}
\DoxyCodeLine{408             \}}
\DoxyCodeLine{409         \}}
\DoxyCodeLine{410     \}}
\DoxyCodeLine{411     \textcolor{comment}{//envoi info reseau à l'IHM}}
\DoxyCodeLine{412     \textcolor{keywordflow}{if} (val != ip) \{ip=val; signal\_x7GestConfig\_init\_mode\_network();\}}
\DoxyCodeLine{413     supervisionlog-\/>debug(\textcolor{stringliteral}{"Interface name: "}+ interface\_name.toStdString() +\textcolor{stringliteral}{" Ip: "}+ ip.toString().toStdString());}
\DoxyCodeLine{414     interfaces.clear();}
\DoxyCodeLine{415 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}\label{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}} 
\index{Supervision\_qobject@{Supervision\_qobject}!priv\_trigger@{priv\_trigger}}
\index{priv\_trigger@{priv\_trigger}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{priv\_trigger}{priv\_trigger}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::priv\+\_\+trigger (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{Supervision\+\_\+qobject\+::priv\+\_\+trigger}}. 


\begin{DoxyItemize}
\item appelé par \mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{demarre\+Trigger()}} avec Stimer à l\textquotesingle{}init
\item appelé par \mbox{\hyperlink{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}{finished\+Slot()}} en récurrence
\item verif interface reseau ok
\item lecture badge\+\_\+db /var/x7/contents/database\+\_\+badge.db
\item si il y a des badgeage en cache on les envoie au serveur par le manager post request 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{601 \{}
\DoxyCodeLine{602     supervisionlog-\/>debug(\textcolor{stringliteral}{"priv\_trigger"});}
\DoxyCodeLine{603     \textcolor{keywordflow}{if}(http\_erreurs<=5)}
\DoxyCodeLine{604         \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{priv\_attente\_ip}}(0);  \textcolor{comment}{//0-\/recherche adresse ip,}}
\DoxyCodeLine{605     \textcolor{keywordflow}{else}}
\DoxyCodeLine{606         \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{priv\_attente\_ip}}(1);  \textcolor{comment}{//1-\/redemarrage interface réseau puis recherche ip}}
\DoxyCodeLine{607 }
\DoxyCodeLine{608     \textcolor{keywordflow}{if}(!badge\_db.open())}
\DoxyCodeLine{609     \{}
\DoxyCodeLine{610         \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(0); \textcolor{comment}{//affichage logo database}}
\DoxyCodeLine{611         supervisionlog-\/>debug(\textcolor{stringliteral}{"pas de connection database"});}
\DoxyCodeLine{612     \}}
\DoxyCodeLine{613     \textcolor{keywordflow}{else}}
\DoxyCodeLine{614     \{}
\DoxyCodeLine{615         QSqlQuery query(badge\_db);}
\DoxyCodeLine{616         query.prepare(\textcolor{stringliteral}{"SELECT matric, heure, jour, activite, key FROM badge LIMIT 1"});}
\DoxyCodeLine{617         query.exec();}
\DoxyCodeLine{618         \textcolor{keywordflow}{if}(query.next())}
\DoxyCodeLine{619         \{}
\DoxyCodeLine{620             supervisionlog-\/>debug(\textcolor{stringliteral}{"badgeage sauvegarde"});}
\DoxyCodeLine{621             \textcolor{keywordtype}{int} key=query.record().value(\textcolor{stringliteral}{"key"}).toInt();}
\DoxyCodeLine{622             QString activite = query.record().value(\textcolor{stringliteral}{"activite"}).toString();}
\DoxyCodeLine{623             QString csn = query.record().value(\textcolor{stringliteral}{"matric"}).toString();}
\DoxyCodeLine{624 }
\DoxyCodeLine{625 \textcolor{comment}{//            QTime t = QTime::fromString(query.record().value("heure").toString(), "hh:mm:ss");}}
\DoxyCodeLine{626 \textcolor{comment}{//            QDate d = QDate::fromString(query.record().value("jour").toString(), "yyyy-\/MM-\/dd");}}
\DoxyCodeLine{627 }
\DoxyCodeLine{628             QDateTime dt = QDateTime::fromString(query.record().value(\textcolor{stringliteral}{"jour"}).toString()+\textcolor{stringliteral}{" "}+query.record().value(\textcolor{stringliteral}{"heure"}).toString(), \textcolor{stringliteral}{"yyyy-\/MM-\/dd hh:mm:ss"});}
\DoxyCodeLine{629             \mbox{\hyperlink{structbadgeage}{badgeage}} *b = \textcolor{keyword}{new} \mbox{\hyperlink{structbadgeage}{badgeage}}(csn,dt,activite,key);}
\DoxyCodeLine{630 }
\DoxyCodeLine{631             quint32 \textcolor{keywordtype}{id} = \mbox{\hyperlink{class_supervision__qobject_a3872374106ab1d30c51b0cd5d539ef86}{nextIdPost}}();}
\DoxyCodeLine{632             badgeCache.insert(\textcolor{keywordtype}{id},b);}
\DoxyCodeLine{633 }
\DoxyCodeLine{634             QString a=QString::number(QDateTime::currentMSecsSinceEpoch());}
\DoxyCodeLine{635             a.append(\textcolor{stringliteral}{" "}+b-\/>toString()+\textcolor{stringliteral}{" "}+time2bii\_name+\textcolor{stringliteral}{" "}+ ip.toString()+\textcolor{stringliteral}{" "}+\textcolor{stringliteral}{"M"});}
\DoxyCodeLine{636             supervisionlog-\/>debug(\textcolor{stringliteral}{" trigger: "} + a.toStdString());}
\DoxyCodeLine{637             QByteArray s1=\mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{encode\_string}}(a.toLatin1());}
\DoxyCodeLine{638             s1.insert(0,\textcolor{stringliteral}{"id="});}
\DoxyCodeLine{639             QNetworkReply *reply =manager-\/>post(*request,s1);}
\DoxyCodeLine{640             reply-\/>setProperty(\textcolor{stringliteral}{"idBadgeage"}, \textcolor{keywordtype}{id});}
\DoxyCodeLine{641         \}}
\DoxyCodeLine{642         \textcolor{keywordflow}{else}}
\DoxyCodeLine{643         \{}
\DoxyCodeLine{644             supervisionlog-\/>debug(\textcolor{stringliteral}{"pas de badgeage : trigger"});}
\DoxyCodeLine{645             QString a(\textcolor{stringliteral}{"Trigger "}+time2bii\_name+\textcolor{stringliteral}{" "}+ ip.toString()+\textcolor{stringliteral}{" "});}
\DoxyCodeLine{646             a.append(QDateTime::currentDateTime().toString(\textcolor{stringliteral}{"yyyy-\/MM-\/dd hh:mm:ss"}));}
\DoxyCodeLine{647             QByteArray s1=\mbox{\hyperlink{class_supervision__qobject_a581d2a0c107a87444b1bc03af4b3ac75}{encode\_string}}(a.toLatin1());}
\DoxyCodeLine{648             s1.insert(0,\textcolor{stringliteral}{"id="});}
\DoxyCodeLine{649             manager-\/>post(*request,s1);}
\DoxyCodeLine{650         \}}
\DoxyCodeLine{651         badge\_db.close();}
\DoxyCodeLine{652     \}}
\DoxyCodeLine{653 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}\label{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}} 
\index{Supervision\_qobject@{Supervision\_qobject}!provideAuthentication@{provideAuthentication}}
\index{provideAuthentication@{provideAuthentication}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{provideAuthentication}{provideAuthentication}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::provide\+Authentication (\begin{DoxyParamCaption}\item[{Q\+Network\+Reply $\ast$}]{reply,  }\item[{Q\+Authenticator $\ast$}]{ator }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}{Supervision\+\_\+qobject\+::provide\+Authentication}}. 


\begin{DoxyParams}{Parameters}
{\em reply} & \\
\hline
{\em ator} & \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{661 \{}
\DoxyCodeLine{662     supervisionlog-\/>debug(\textcolor{stringliteral}{"authentication"});}
\DoxyCodeLine{663     reply-\/>attribute(QNetworkRequest::HttpStatusCodeAttribute);}
\DoxyCodeLine{664     ator-\/>setUser(http\_user);}
\DoxyCodeLine{665     ator-\/>setPassword(http\_password);}
\DoxyCodeLine{666 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}\label{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}} 
\index{Supervision\_qobject@{Supervision\_qobject}!sauvegardeBadge@{sauvegardeBadge}}
\index{sauvegardeBadge@{sauvegardeBadge}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{sauvegardeBadge()}{sauvegardeBadge()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::sauvegarde\+Badge (\begin{DoxyParamCaption}\item[{int}]{id }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_aec58c856e33e0098314a30c821d9e7d5}{Supervision\+\_\+qobject\+::sauvegarde\+Badge}}. 


\begin{DoxyItemize}
\item sauvegarde badgeage en bdd 
\begin{DoxyParams}{Parameters}
{\em id} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{717 \{}
\DoxyCodeLine{718     supervisionlog-\/>debug(\textcolor{stringliteral}{"sauvegardeBadge"});}
\DoxyCodeLine{719     \textcolor{keywordflow}{if} (!badge\_db.open())}
\DoxyCodeLine{720     \{}
\DoxyCodeLine{721         \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(0); \textcolor{comment}{//affichage logo database}}
\DoxyCodeLine{722         supervisionlog-\/>debug(\textcolor{stringliteral}{"database not open"});}
\DoxyCodeLine{723     \}}
\DoxyCodeLine{724     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(badgeCache.contains(\textcolor{keywordtype}{id}))}
\DoxyCodeLine{725     \{}
\DoxyCodeLine{726         \mbox{\hyperlink{structbadgeage}{badgeage}} *b = badgeCache[id];}
\DoxyCodeLine{727 }
\DoxyCodeLine{728         QSqlQuery query(badge\_db);}
\DoxyCodeLine{729         query.prepare(\textcolor{stringliteral}{"INSERT INTO badge (heure, jour, matric,activite)"} \textcolor{stringliteral}{"VALUES (:heure, :jour, :matric, :activite);"});}
\DoxyCodeLine{730         query.bindValue(\textcolor{stringliteral}{":heure"},b-\/>timeToString());}
\DoxyCodeLine{731         query.bindValue(\textcolor{stringliteral}{":jour"}, b-\/>dateToString());}
\DoxyCodeLine{732         query.bindValue(\textcolor{stringliteral}{":matric"}, b-\/>csn);}
\DoxyCodeLine{733         query.bindValue(\textcolor{stringliteral}{":activite"},b-\/>activite);}
\DoxyCodeLine{734         query.exec();}
\DoxyCodeLine{735 }
\DoxyCodeLine{736         \textcolor{keywordflow}{if} (query.lastError().type() != 0)}
\DoxyCodeLine{737         \{}
\DoxyCodeLine{738             \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(0); \textcolor{comment}{//affichage logo database}}
\DoxyCodeLine{739             b-\/>dbKey =  query.lastInsertId().toInt();}
\DoxyCodeLine{740         \}}
\DoxyCodeLine{741         \textcolor{keywordflow}{else}}
\DoxyCodeLine{742         \{}
\DoxyCodeLine{743             \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(1); \textcolor{comment}{//pas de logo database}}
\DoxyCodeLine{744         \}}
\DoxyCodeLine{745         \textcolor{comment}{//query.finish();}}
\DoxyCodeLine{746 }
\DoxyCodeLine{747         \textcolor{comment}{//badge\_db.commit();}}
\DoxyCodeLine{748         badge\_db.close();}
\DoxyCodeLine{749     \}}
\DoxyCodeLine{750 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ad029236018c16cac96497b4ab136dac6}\label{class_supervision__qobject_ad029236018c16cac96497b4ab136dac6}} 
\index{Supervision\_qobject@{Supervision\_qobject}!setTime2bii\_name@{setTime2bii\_name}}
\index{setTime2bii\_name@{setTime2bii\_name}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{setTime2bii\_name()}{setTime2bii\_name()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::set\+Time2bii\+\_\+name (\begin{DoxyParamCaption}\item[{const Q\+String \&}]{value }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_ad029236018c16cac96497b4ab136dac6}{Supervision\+\_\+qobject\+::set\+Time2bii\+\_\+name}}. 


\begin{DoxyParams}{Parameters}
{\em value} & \\
\hline
\end{DoxyParams}

\begin{DoxyCode}{0}
\DoxyCodeLine{790 \{}
\DoxyCodeLine{791     supervisionlog-\/>debug(\textcolor{stringliteral}{"setTime2bii\_name"});}
\DoxyCodeLine{792     time2bii\_name = value;}
\DoxyCodeLine{793 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}\label{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}} 
\index{Supervision\_qobject@{Supervision\_qobject}!supervision\_badge\_db\_status@{supervision\_badge\_db\_status}}
\index{supervision\_badge\_db\_status@{supervision\_badge\_db\_status}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{supervision\_badge\_db\_status()}{supervision\_badge\_db\_status()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::supervision\+\_\+badge\+\_\+db\+\_\+status (\begin{DoxyParamCaption}\item[{int}]{a }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{Supervision\+\_\+qobject\+::supervision\+\_\+badge\+\_\+db\+\_\+status}}. 


\begin{DoxyItemize}
\item appel signal\+\_\+ihm\+\_\+badge\+\_\+db\+\_\+status() pour afficher en I\+HM le logo badgeage
\item à l\textquotesingle{}init a=1, pas d\textquotesingle{}affichage du logo
\item si a=0 , on affiche le logo badgeage 
\begin{DoxyParams}{Parameters}
{\em a} & \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{831 \{}
\DoxyCodeLine{832     supervisionlog-\/>debug(\textcolor{stringliteral}{"supervision\_badge\_db\_status"});}
\DoxyCodeLine{833      \textcolor{keywordflow}{if} (badge\_db\_etat!=a)}
\DoxyCodeLine{834         \{}
\DoxyCodeLine{835          supervisionlog-\/>debug(\textcolor{stringliteral}{"badge\_db\_etat \%d != a \%d "}, badge\_db\_etat, a);}
\DoxyCodeLine{836          \textcolor{keywordflow}{if} (a==0)}
\DoxyCodeLine{837              supervisionlog-\/>debug(\textcolor{stringliteral}{"logo database affiché"});}
\DoxyCodeLine{838          \textcolor{keywordflow}{else} \textcolor{comment}{//a=0}}
\DoxyCodeLine{839          \{}
\DoxyCodeLine{840              supervisionlog-\/>debug(\textcolor{stringliteral}{"pas de logo database"});}
\DoxyCodeLine{841          \}}
\DoxyCodeLine{842          emit signal\_ihm\_badge\_db\_status(QVariant(a));\textcolor{comment}{// signal vers ihm}}
\DoxyCodeLine{843          badge\_db\_etat=a;}
\DoxyCodeLine{844         \}}
\DoxyCodeLine{845  \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}\label{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}} 
\index{Supervision\_qobject@{Supervision\_qobject}!supervision\_http\_status@{supervision\_http\_status}}
\index{supervision\_http\_status@{supervision\_http\_status}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{supervision\_http\_status}{supervision\_http\_status}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::supervision\+\_\+http\+\_\+status (\begin{DoxyParamCaption}\item[{int}]{a }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{Supervision\+\_\+qobject\+::supervision\+\_\+http\+\_\+status}}. 


\begin{DoxyItemize}
\item Check status connexion http pour affichage logo alerte
\item appel signal ihm\+\_\+http\+\_\+status pour maj ihm 
\begin{DoxyParams}{Parameters}
{\em a$<$=0} & le logo est affiché (qml opacity=1), a=1 le logo est supprimé, connexion ok (qml opacity=0) \\
\hline
\end{DoxyParams}

\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{802 \{}
\DoxyCodeLine{803     supervisionlog-\/>debug(\textcolor{stringliteral}{"supervision http\_status"});}
\DoxyCodeLine{804     \textcolor{comment}{// a l'init http\_etat=0}}
\DoxyCodeLine{805     \textcolor{keywordflow}{if} (http\_etat!=a)}
\DoxyCodeLine{806     \{}
\DoxyCodeLine{807         supervisionlog-\/>debug(\textcolor{stringliteral}{"http\_etat \%d != a \%d "}, http\_etat, a);}
\DoxyCodeLine{808         http\_etat=a;}
\DoxyCodeLine{809         \textcolor{keywordflow}{if} (a <=0 )}
\DoxyCodeLine{810         \{}
\DoxyCodeLine{811             a=0;}
\DoxyCodeLine{812             supervisionlog-\/>debug(\textcolor{stringliteral}{"signal\_ihm\_http\_status logo alerte affiché"});}
\DoxyCodeLine{813         \}}
\DoxyCodeLine{814         \textcolor{keywordflow}{else} \textcolor{comment}{//a=1}}
\DoxyCodeLine{815         \{}
\DoxyCodeLine{816             supervisionlog-\/>debug(\textcolor{stringliteral}{"signal\_ihm\_http\_status logo alerte supprimé, connexion ok"});}
\DoxyCodeLine{817         \}}
\DoxyCodeLine{818         emit signal\_ihm\_http\_status(QVariant(a));\textcolor{comment}{// signal pour afficher le logo alerte\_http sur l'ihm page d'accueil}}
\DoxyCodeLine{819     \}}
\DoxyCodeLine{820 }
\DoxyCodeLine{821  \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_abe8123ea66b3ce11ba6c06ec5c5e441e}\label{class_supervision__qobject_abe8123ea66b3ce11ba6c06ec5c5e441e}} 
\index{Supervision\_qobject@{Supervision\_qobject}!supervision\_init@{supervision\_init}}
\index{supervision\_init@{supervision\_init}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{supervision\_init()}{supervision\_init()}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::supervision\+\_\+init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



\mbox{\hyperlink{class_supervision__qobject_abe8123ea66b3ce11ba6c06ec5c5e441e}{Supervision\+\_\+qobject\+::supervision\+\_\+init}}. 


\begin{DoxyItemize}
\item appelé par \mbox{\hyperlink{class_supervision__qthread_a2c55283e05ee364b503164e79e7ce63f}{Supervision\+\_\+qthread\+::run()}}
\item appel 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{54 \{}
\DoxyCodeLine{55     supervisionlog-\/>debug(\textcolor{stringliteral}{"supervision init"});}
\DoxyCodeLine{56     QTimer *timer\_init =\textcolor{keyword}{new} QTimer();}
\DoxyCodeLine{57     timer\_init-\/>setSingleShot(\textcolor{keyword}{true});}
\DoxyCodeLine{58     connect(timer\_init,SIGNAL(timeout()),\textcolor{keyword}{this},SLOT(\mbox{\hyperlink{class_supervision__qobject_af9f5951af6651fdefa1c886b77bac292}{supervision\_init0}}()));}
\DoxyCodeLine{59     timer\_init-\/>start(1);}
\DoxyCodeLine{60 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_af9f5951af6651fdefa1c886b77bac292}\label{class_supervision__qobject_af9f5951af6651fdefa1c886b77bac292}} 
\index{Supervision\_qobject@{Supervision\_qobject}!supervision\_init0@{supervision\_init0}}
\index{supervision\_init0@{supervision\_init0}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{supervision\_init0}{supervision\_init0}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::supervision\+\_\+init0 (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [slot]}}



init de l\textquotesingle{}objet 


\begin{DoxyItemize}
\item creation trigger Stimer
\item ceation badge\+\_\+db /var/x7/contents/database\+\_\+badge.db"
\item creation manager pour gestion des network request et envoi de data
\item creation request pour la network request
\item appel \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{priv\+\_\+attente\+\_\+ip()}} recherche adresse ip
\item appel \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\+\_\+http\+\_\+status()}} param -\/1 pour affichage ihm du logo alerte
\item appel signal\+\_\+process\+\_\+init\+\_\+http() lecture datatbase\+\_\+setup.\+db et init infos ihm
\item appel \mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{supervision\+\_\+init\+\_\+http()}} connexion serveur http/https (chronotime) 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{76 \{}
\DoxyCodeLine{77     supervisionlog-\/>debug(\textcolor{stringliteral}{"supervision\_init0(void)"});}
\DoxyCodeLine{78     http\_initok=0;}
\DoxyCodeLine{79     idPost=0;}
\DoxyCodeLine{80     Stimer =\textcolor{keyword}{new} QTimer();}
\DoxyCodeLine{81     Stimer-\/>setSingleShot(\textcolor{keyword}{true});}
\DoxyCodeLine{82     connect(Stimer,SIGNAL(timeout()),\textcolor{keyword}{this},SLOT(\mbox{\hyperlink{class_supervision__qobject_ab6ba8601efd8c65c993ed0257a7da808}{priv\_trigger}}()));}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     manager=\textcolor{keyword}{new} QNetworkAccessManager(\textcolor{keyword}{this}) ;}
\DoxyCodeLine{85     request= \textcolor{keyword}{new} QNetworkRequest();}
\DoxyCodeLine{86     connect(manager, SIGNAL(authenticationRequired(QNetworkReply*,QAuthenticator*)),\textcolor{keyword}{this},}
\DoxyCodeLine{87             SLOT(\mbox{\hyperlink{class_supervision__qobject_ae44fe2ee8b0658cb46bdb05f0743d1bb}{provideAuthentication}}(QNetworkReply*,QAuthenticator*)));}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     connect(manager, SIGNAL(finished(QNetworkReply*)),\textcolor{keyword}{this}, SLOT(\mbox{\hyperlink{class_supervision__qobject_a7872d6e9398e1cf335c2eb044ac062f9}{finishedSlot}}(QNetworkReply*)));}
\DoxyCodeLine{90     timerloop.setSingleShot(\textcolor{keyword}{true});}
\DoxyCodeLine{91 }
\DoxyCodeLine{92     \textcolor{comment}{// Creation database badge}}
\DoxyCodeLine{93     badge\_db = QSqlDatabase::addDatabase(\textcolor{stringliteral}{"QSQLITE"},\textcolor{stringliteral}{"supervision\_badge"});}
\DoxyCodeLine{94     badge\_db.setDatabaseName(\textcolor{stringliteral}{"/var/x7/contents/database\_badge.db"});}
\DoxyCodeLine{95     \textcolor{keywordflow}{if} (badge\_db.open())}
\DoxyCodeLine{96     \{}
\DoxyCodeLine{97         QSqlQueryModel model;}
\DoxyCodeLine{98         QSqlQuery query(badge\_db);}
\DoxyCodeLine{99         model.setQuery(\textcolor{stringliteral}{"SELECT * FROM badge"},badge\_db);}
\DoxyCodeLine{100         \textcolor{keywordflow}{if} (!model.rowCount()) query.exec(QString(\textcolor{stringliteral}{"DROP TABLE badge"}));}
\DoxyCodeLine{101         query.exec(QString(\textcolor{stringliteral}{"CREATE TABLE badge (matric varchar(30),heure varchar(10),jour varchar(10),activite varchar(10),key INTEGER PRIMARY KEY AUTOINCREMENT)"}));}
\DoxyCodeLine{102         query.clear();}
\DoxyCodeLine{103         query.finish();}
\DoxyCodeLine{104         badge\_db.close();}
\DoxyCodeLine{105         model.clear();}
\DoxyCodeLine{106         model.deleteLater();}
\DoxyCodeLine{107     \}}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     badge\_db\_etat=-\/1;}
\DoxyCodeLine{110     \mbox{\hyperlink{class_supervision__qobject_a3f008ec6a0e9c93985f9ee7b60c55c7c}{supervision\_badge\_db\_status}}(1); \textcolor{comment}{//pas de logo database}}
\DoxyCodeLine{111     http\_etat=0;}
\DoxyCodeLine{112     time\_out=1;}
\DoxyCodeLine{113     http\_erreurs=0;}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(-\/2); \textcolor{comment}{//affichage du logo alerte\_http}}
\DoxyCodeLine{116     \mbox{\hyperlink{class_supervision__qobject_a08f9d7d14d0b24fa7c248524b756a436}{priv\_attente\_ip}}(0); \textcolor{comment}{// param ok=0 recherche adresse ip (pas de lancement de /etc/init.d/networking restart déja fait au reset)}}
\DoxyCodeLine{117     \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(-\/1); \textcolor{comment}{//affichage du logo alerte\_http}}
\DoxyCodeLine{118 }
\DoxyCodeLine{119     \textcolor{comment}{// Lecture database config supervision}}
\DoxyCodeLine{120     http\_server.clear();}
\DoxyCodeLine{121     http\_port\_https.clear();http\_port\_http.clear();http\_service.clear();http\_user.clear();http\_password.clear();http\_timeout=\textcolor{charliteral}{'5'};}
\DoxyCodeLine{122     emit signal\_process\_init\_http(); \textcolor{comment}{// lecture datatabase\_setup.db pour affichage informations du serveur sur IHM}}
\DoxyCodeLine{123     \mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{supervision\_init\_http}}(); \textcolor{comment}{//Connexion serveur http/https (chronotime) et suppression logo alerte\_http si pas d'erreur}}
\DoxyCodeLine{124 }
\DoxyCodeLine{125 \}}

\end{DoxyCode}
\mbox{\Hypertarget{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}\label{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}} 
\index{Supervision\_qobject@{Supervision\_qobject}!supervision\_init\_http@{supervision\_init\_http}}
\index{supervision\_init\_http@{supervision\_init\_http}!Supervision\_qobject@{Supervision\_qobject}}
\doxysubsubsection{\texorpdfstring{supervision\_init\_http}{supervision\_init\_http}}
{\footnotesize\ttfamily void Supervision\+\_\+qobject\+::supervision\+\_\+init\+\_\+http (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [slot]}}



\mbox{\hyperlink{class_supervision__qobject_ac8df95cecb93b60eff023813ad07b256}{Supervision\+\_\+qobject\+::supervision\+\_\+init\+\_\+http}}. 


\begin{DoxyItemize}
\item Connexion serveur http/https (chronotime)
\item appel \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\+\_\+http\+\_\+status()}} param -\/1 //affichage logo alerte
\item appel \mbox{\hyperlink{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}{attente\+\_\+ssl\+\_\+certificat()}} en cas de serveur https
\item gestion time2bii 1.\+1.\+13 Serveur Chronotime (my.\+crypt) ou Gnet (my.\+crypt\+Gnet)
\item appel \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\+\_\+http\+\_\+status()}} param 1 //suppression logo alerte
\item appel \mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{demarre\+Trigger()}} premier trigger Stimer 
\end{DoxyItemize}
\begin{DoxyCode}{0}
\DoxyCodeLine{159 \{}
\DoxyCodeLine{160     supervisionlog-\/>debug(\textcolor{stringliteral}{"supervision init\_http"});}
\DoxyCodeLine{161     timerloop.stop();}
\DoxyCodeLine{162     http\_initok=0;}
\DoxyCodeLine{163     http\_etat=0;}
\DoxyCodeLine{164     time\_out=1;}
\DoxyCodeLine{165     http\_erreurs=0;}
\DoxyCodeLine{166 }
\DoxyCodeLine{167     \mbox{\hyperlink{class_supervision__qobject_aeaa48b22bad4950ae3740358a71702ed}{supervision\_http\_status}}(-\/1); \textcolor{comment}{//affichage du logo alerte\_http}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169     QString a=QString(\textcolor{stringliteral}{"Configuration http: serveur= \%1 port https= \%2 port http= \%3 service= \%4 user= \%5 password= \%6 timeout= \%7 "})}
\DoxyCodeLine{170             .arg(http\_server).arg(http\_port\_https).arg(http\_port\_http).arg(http\_service).arg(http\_user).arg(http\_password).arg(http\_timeout);}
\DoxyCodeLine{171     supervisionlog-\/>debug(a.toStdString());}
\DoxyCodeLine{172 }
\DoxyCodeLine{173     QString UrlString;}
\DoxyCodeLine{174     \textcolor{keywordflow}{if} (!http\_server.isEmpty())}
\DoxyCodeLine{175     \{}
\DoxyCodeLine{176         qDebug() << \textcolor{stringliteral}{"http\_server not empty"};}
\DoxyCodeLine{177         \textcolor{keywordflow}{if}(!http\_port\_https.isEmpty()) \textcolor{comment}{//Préparer utilisation HTTPS SSL}}
\DoxyCodeLine{178         \{}
\DoxyCodeLine{179             qDebug() << \textcolor{stringliteral}{"http\_port\_https not empty"};}
\DoxyCodeLine{180             ssl\_certificat.setFileName(\textcolor{stringliteral}{"certificat.crt"});}
\DoxyCodeLine{181             ssl\_certificat.remove();}
\DoxyCodeLine{182             \mbox{\hyperlink{class_supervision__qobject_abc3e1b77f2bc7881cb32920ec1dd088d}{attente\_ssl\_certificat}}();}
\DoxyCodeLine{183 }
\DoxyCodeLine{184             QList<QSslCertificate> cert = QSslCertificate::fromPath(QLatin1String(\textcolor{stringliteral}{"certificat.crt"}),QSsl::Pem,QRegExp::FixedString);}
\DoxyCodeLine{185             ssl\_certificat.remove();}
\DoxyCodeLine{186             SslConfiguration= \textcolor{keyword}{new} QSslConfiguration(QSslConfiguration::defaultConfiguration());}
\DoxyCodeLine{187             \textcolor{keywordflow}{if} (!cert.isEmpty())}
\DoxyCodeLine{188             \{}
\DoxyCodeLine{189                 qDebug() << \textcolor{stringliteral}{"cert not empty"};}
\DoxyCodeLine{190                 QSslKey mykey(cert.first().publicKey());}
\DoxyCodeLine{191                 SslConfiguration-\/>setCaCertificates(cert);}
\DoxyCodeLine{192                 SslConfiguration-\/>setLocalCertificate(cert.first());}
\DoxyCodeLine{193                 SslConfiguration-\/>setPrivateKey(mykey);}
\DoxyCodeLine{194                 UrlString=QString(\textcolor{stringliteral}{"https://\%1:\%2\%3"}).arg(http\_server).arg(http\_port\_https).arg(http\_service);}
\DoxyCodeLine{195             \}}
\DoxyCodeLine{196             \textcolor{keywordflow}{else}}
\DoxyCodeLine{197             \{}
\DoxyCodeLine{198                 qDebug() << \textcolor{stringliteral}{"cert empty"};}
\DoxyCodeLine{199                 http\_port\_https.clear();}
\DoxyCodeLine{200                 UrlString=QString(\textcolor{stringliteral}{"http://\%1:\%2\%3"}).arg(http\_server).arg(http\_port\_http).arg(http\_service);}
\DoxyCodeLine{201             \}}
\DoxyCodeLine{202         \}}
\DoxyCodeLine{203         \textcolor{keywordflow}{else}}
\DoxyCodeLine{204         \{}
\DoxyCodeLine{205             qDebug() << \textcolor{stringliteral}{"http\_port\_https empty"};}
\DoxyCodeLine{206             UrlString=QString(\textcolor{stringliteral}{"http://\%1:\%2\%3"}).arg(http\_server).arg(http\_port\_http).arg(http\_service);}
\DoxyCodeLine{207         \}}
\DoxyCodeLine{208         url.setUrl(UrlString);}
\DoxyCodeLine{209         request-\/>setUrl(url);}
\DoxyCodeLine{210         request-\/>setHeader(QNetworkRequest::ContentTypeHeader,\textcolor{stringliteral}{"text/plain"});}
\DoxyCodeLine{211         request-\/>setUrl(url);}
\DoxyCodeLine{212         \textcolor{comment}{// Config pour HTTPS SSL}}
\DoxyCodeLine{213         \textcolor{keywordflow}{if} (!http\_port\_https.isEmpty()) request-\/>setSslConfiguration(*SslConfiguration);}
\DoxyCodeLine{214     \}}
\DoxyCodeLine{215     version\_logiciel.clear();}
\DoxyCodeLine{216     version\_logiciel.append(version\_logiciel\_i);}
\DoxyCodeLine{217     \textcolor{comment}{// MODIF version time2bii-\/1.13}}
\DoxyCodeLine{218     \textcolor{comment}{//Fichier de cryptage different si Serveur Chronotime (my.crypt) ou Gnet (my.cryptGnet)}}
\DoxyCodeLine{219     QFile in;}
\DoxyCodeLine{220     \textcolor{keywordflow}{if} (http\_service.contains(\textcolor{stringliteral}{"chronotime"},Qt::CaseInsensitive)) in.setFileName(\textcolor{stringliteral}{"/var/x7/contents/ssl/my.crypt"});}
\DoxyCodeLine{221     \textcolor{keywordflow}{else} in.setFileName(\textcolor{stringliteral}{"/var/x7/contents/ssl/my.cryptGnet"});}
\DoxyCodeLine{222     \textcolor{keywordflow}{if} (in.open( QFile::ReadOnly))}
\DoxyCodeLine{223     \{}
\DoxyCodeLine{224         QTextStream stream\_in(\&in);}
\DoxyCodeLine{225         key\_crypt = stream\_in.readAll();}
\DoxyCodeLine{226         \textcolor{keywordflow}{if} (key\_crypt.isEmpty())}
\DoxyCodeLine{227         \{}
\DoxyCodeLine{228             key\_crypt.append(\textcolor{stringliteral}{"on peut rire de tout mais pas avec tout le monde"});}
\DoxyCodeLine{229             version\_logiciel.append(\textcolor{stringliteral}{" (b)"});}
\DoxyCodeLine{230         \}}
\DoxyCodeLine{231         \textcolor{keywordflow}{else}}
\DoxyCodeLine{232         \{}
\DoxyCodeLine{233             \mbox{\hyperlink{class_encryption}{Encryption}} *encry = \textcolor{keyword}{new} \mbox{\hyperlink{class_encryption}{Encryption}}();}
\DoxyCodeLine{234             \textcolor{keywordtype}{string} msg= encry-\/>encryption(\textcolor{stringliteral}{"on peut rire de tout mais pas avec tout le monde"}, QString(key\_crypt), \textcolor{stringliteral}{"AES\_base64"}, \textcolor{keyword}{false});}
\DoxyCodeLine{235             key\_crypt= QString::fromStdString(msg);}
\DoxyCodeLine{236             version\_logiciel.append(\textcolor{stringliteral}{" (c)"});}
\DoxyCodeLine{237         \}}
\DoxyCodeLine{238         in.close();}
\DoxyCodeLine{239     \}}
\DoxyCodeLine{240     \textcolor{keywordflow}{else}}
\DoxyCodeLine{241     \{}
\DoxyCodeLine{242         key\_crypt.clear();}
\DoxyCodeLine{243         version\_logiciel.append(\textcolor{stringliteral}{" (a)"});}
\DoxyCodeLine{244     \}}
\DoxyCodeLine{245     supervisionlog-\/>debug(\textcolor{stringliteral}{"Cryptage: \%s"}, key\_crypt.toStdString());}
\DoxyCodeLine{246     \mbox{\hyperlink{class_hashes}{Hashes}} *hash = \textcolor{keyword}{new} \mbox{\hyperlink{class_hashes}{Hashes}}();}
\DoxyCodeLine{247     \textcolor{keywordtype}{string} msg=hash-\/>Sha256Function(key\_crypt);}
\DoxyCodeLine{248     \textcolor{comment}{//supervisionlog-\/>debug("Cryptage HEX: "+QString::fromStdString(msg));}}
\DoxyCodeLine{249     supervisionlog-\/>debug(\textcolor{stringliteral}{"Cryptage HEX: "}+msg);}
\DoxyCodeLine{250     supervisionlog-\/>debug(\textcolor{stringliteral}{"Version Logiciel: "}+version\_logiciel.toStdString());}
\DoxyCodeLine{251     \textcolor{comment}{//supervision\_http\_status(1); //suppression du logo alerte\_http}}
\DoxyCodeLine{252     http\_initok=1;}
\DoxyCodeLine{253     \mbox{\hyperlink{class_supervision__qobject_a3b7a64a6c790dd5811b70eb1b5ee08b1}{demarreTrigger}}(30); \textcolor{comment}{//appel priv\_trigger}}
\DoxyCodeLine{254 \}}

\end{DoxyCode}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{supervision_8h}{supervision.\+h}}\item 
\mbox{\hyperlink{supervision_8cpp}{supervision.\+cpp}}\end{DoxyCompactItemize}
